<!DOCTYPE html>
<html><head><meta charset='UTF-8'></meta>
<title>centaurihelp â”€ _centauri_bash_dyn</title>
<link rel='stylesheet' type='text/css' href='default.css'></link>
<script type='text/javascript' src='default.js'></script>
</head><body><article id='top'>
<nav><div class='nav-row'>
<div class='nav-left'><a href='_centauri_bash_doc.html'>[&lt;&lt; previous]</a></div>
<div class='nav-mid'><a href='content.html#top'>[Content]</a></div>
<div class='nav-mid'><a href='reference.html#top'>[Reference]</a></div>
<div class='nav-right'><a href='_centauri_bash_ext.html'>[next &gt;&gt;]</a></div>
</div></nav>
<section id='section-1'>
<div id='_centauri_bash_dyn' class='item-module'>
<span>Module</span><span> - </span><span>_centauri_bash_dyn</span><span> - </span><span><a href="index.html">Centauri Bash Library</a> Dynamic Module loading</span></div>
<div class='def-row'>
<div class='def-label'>Call:</div>
<div class='def-text'>only via <a href="_centauri_bash_lib.html">_centauri_bash_lib</a> <b>-a</b></div>
</div>
<div class='def-row'>
<div class='def-label'>Remark:</div>
<div class='def-block'>This module is created by the <b>autoload</b> utility at installation time. It contains proxy function definitions to dynamically load modules and to enable loadable bash builtins.</div>
</div>
</section>
<section id='section-2'>
<div id='dynamicloading' class='item-topic'>
<span>Topic</span><span> - </span><span>Dynamic loading</span><span> - </span><span>Dynamic loading of <a href="index.html">_centauri_bash_lib</a> modules</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The library is split into modules and these modules need to be loaded somehow. The main module <a href="_centauri_bash_lib.html">_centauri_bash_lib</a> must be loaded explicitly from the user script. For additional modules there exist four methods of loading them:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>(1) _centauri_bash_lib <b>-m</b> option: load a module by 3 letter name
(2) _centauri_bash_lib <b>-g</b> option: <a href="_centauri_bash_con.html">_centauri_bash_con</a> or <a href="_centauri_bash_win.html">_centauri_bash_win</a>
    _centauri_bash_lib <b>-v</b> option: <a href="_centauri_bash_svc.html">_centauri_bash_svc</a> syslog/service
(3) _centauri_bash_lib <b>-a</b> option: autoload via <a href="_centauri_bash_dyn.html">_centauri_bash_dyn</a>
(4) explicit loading via <a href="_centauri_bash_lib.html#embed">embed()</a> option <b>-m</b></div>
</div>
<div class='def-row'>
<div class='def-label'>Examples:</div>
<div class='def-text'>Loading <a href="_centauri_bash_win.html">_centauri_bash_win</a> using method (1):<pre>PATH+=<b>&quot;:${0%/*}&quot;</b> . _centauri_bash_lib <b>-m</b> win <b>&quot;$0&quot;</b> <b>&quot;0.00&quot;</b> || exit 2</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>Explicitly loading <a href="_centauri_bash_win.html">_centauri_bash_win</a> using method (4):<pre>embed <b>-m</b> _centauri_bash_win</pre></div>
</div>
<div class='def-row'>
<div class='def-label'>Options:</div>
<div class='def-block'>At load time options can be passed to a module. This either happens implicitly (method 2) or explicitly (method 4). See <a href="_centauri_bash_lib.html#embed">embed()</a>. The available options are documented in the description of each module.</div>
</div>
<div class='def-row'>
<div class='def-label'>Limits:</div>
<div class='def-text'>Some modules cannot be autoloaded:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><a href="_centauri_bash_dyn.html">_centauri_bash_dyn</a> - must be loaded via <b>&quot;_centauri_bash_lib -a&quot;</b>
<a href="_centauri_bash_lib.html">_centauri_bash_lib</a> - must be loaded by user script
<a href="_centauri_bash_dbg.html">_centauri_bash_dbg</a> - debug module: use <b>&quot;embed _centauri_bash_dbg -m -a&quot;</b>
                     to debug <a href="_centauri_bash_lib.html#main">main()</a> and <a href="_centauri_bash_dbg.html#optionsuser">options()</a></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>For some modules an explicit load (before invoking <a href="_centauri_bash_lib.html#main">main()</a>) adds command line options:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><a href="_centauri_bash_bat.html">_centauri_bash_bat</a> - use <b>_centauri_bash_lib -m bat</b>
<a href="_centauri_bash_con.html">_centauri_bash_con</a> - use <b>_centauri_bash_lib -m con</b> or <b>-g</b>
<a href="_centauri_bash_iom.html">_centauri_bash_iom</a> - use <b>embed -m _centauri_bash_iom &lt;option&gt;...</b>
<a href="_centauri_bash_mnt.html">_centauri_bash_mnt</a> - use <b>embed -m _centauri_bash_mnt &lt;option&gt;...</b>
<a href="_centauri_bash_tra.html">_centauri_bash_tra</a> - use <b>_centauri_bash_lib -m tra</b>
<a href="_centauri_bash_win.html">_centauri_bash_win</a> - use <b>_centauri_bash_lib -m win</b> or <b>-g</b></div>
</div>
<div class='def-row'>
<div class='def-label'>Setup:</div>
<div class='def-block'>The <a href="_centauri_bash_dyn.html">_centauri_bash_dyn</a> module, that handles autoload, is generated using the program <b>autoload</b>. Usually called as (see help for <a href="#builtin">builtin</a>):</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>&gt; <b>$CEN_ROOT/library/autoload --builtin</b></div>
</div>
</section>
<section id='section-3'>
<div id='builtin' class='item-topic'>
<span>Topic</span><span> - </span><span>Builtin</span><span> - </span><span>Using loadable bash builtins</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The library tries to avoid calls to external (e.g. non-builtin) tools whenever possible. Bash has a lot of builtins, see <b>&quot;help enable&quot;</b>. For your linux distribution some extra builtins (bash examples) may be provided (on a debian system use <b>&quot;apt install bash-builtins&quot;</b>). The library will use installed builtins for <b>mkdir</b>, <b>rmdir</b>, <b>rm</b>, <b>ln</b>, <b>unlink</b>, <b>mkfifo</b>,  <b>sleep</b> and <b>realpath</b>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The <b>&quot;$CEN_ROOT/library/autoload&quot;</b> tool can generate wrappers that attempt to autoload bash builtins, not causing harm if a builtin is not installed. See <b>autoload</b> option <b>--builtin</b>.</div>
</div>
<div class='def-row'>
<div class='def-label'>Warnings:</div>
<div class='def-block'>(1) The builtins comming with bash have less functionality than the corresponding GNU tools. <a href="_centauri_bash_ext.html">_centauri_bash_ext</a> is aware of this and uses builtins in a safe way.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre># For example builtin &apos;ln&apos; does not support option &apos;<b>-r</b>&apos;
                    # per default system does not use builtins ...
system <b>--</b> ln <b>-s</b> <b>-r</b> something unsafe
                    # but sysrun needs option -i ...
sysrun <b>-i</b> <b>--</b> ln <b>-s</b> <b>-r</b> something unsafe</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>(2) Builtins are only loaded if <a href="_centauri_bash_dyn.html">_centauri_bash_dyn</a> is enabled via <b>CEN_FEATURE_A</b> (library option <b>-a</b>).</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre># add option &apos;<b>-a</b>&apos; to load _centauri_bash_dyn
PATH+=<b>&quot;:${0%/*}&quot;</b> . _centauri_bash_lib <b>-a</b> <b>-d</b> <b>-r</b> <b>&quot;$0&quot;</b> <b>&quot;0.00:1&quot;</b> || exit 2</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>(3) Builtins are best used via <a href="_centauri_bash_ext.html#sysrun">sysrun()</a> or by the library code itself, for example <a href="_centauri_bash_ext.html#move">move()</a>, <a href="_centauri_bash_ext.html#remove">remove()</a> or <a href="_centauri_bash_ext.html#symlink">symlink()</a>.</div>
</div>
</section>
<section id='section-4'>
<div id='preprocessing' class='item-topic'>
<span>Topic</span><span> - </span><span>Preprocessing</span><span> - </span><span>Preprocessing modules sources to reduce startup time</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The modules contain a lot of documentation and other comments. In order to load faster, these can be removed using <a href="uglify.html">uglify</a>. This tool also removes extra spaces and replaces some strings that are noted using quotes by strings using apostrophes.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The resulting files receive a <b>&quot;.p&quot;</b> ending and are loaded via proxy or <a href="_centauri_bash_lib.html">_centauri_bash_lib</a> whenever the preprocessed file is newer than the source.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><a href="uglify.html">uglify</a> preserves line numbers in order to help debugging.</div>
</div>
<div class='def-row'>
<div class='def-label'>Setup:</div>
<div class='def-text'>&gt; <b>$CEN_ROOT/library/uglify -</b></div>
</div>
<div class='def-row'>
<div class='def-label'>Warning:</div>
<div class='def-block'><a href="uglify.html">uglify</a> is stupid. It well understands the coding style of the library modules but may fail to process other coding styles correctly.</div>
</div>
</section>
<section id='section-5'>
<div id='custommodules' class='item-topic'>
<span>Topic</span><span> - </span><span>Custom Modules</span><span> - </span><span>Extending <a href="index.html">_centauri_bash_lib</a> with custom library modules</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-text'>Two kinds of custom library modules are supported</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>(1) in-tree
    - placed inside <b>$CEN_LIBRARY</b>
    - naming pattern must be &apos;*_*_usr&apos;
    - dynamic loading is supported
    - recognized by <b>autoload</b>, <b>uglify</b> and <b>centaurihelp</b></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>(2) out-of-tree
    - can be at any place
    - can have any name
    - must be loaded explicitly
    - help needs <b>centaurihelp --use=</b><i>module</i></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The module kind is defined by its installation location. The code itself makes no difference (except for the naming pattern).</div>
</div>
<div class='def-row'>
<div class='def-label'>Example:</div>
<div class='def-text'>See <b>$CEN_TOOLS\templates\_custom_module_usr</b></div>
</div>
</section>
</article>
<div class='def-break'></div>
<nav><div class='nav-row'>
<div class='nav-left'><a href='_centauri_bash_doc.html'>[&lt;&lt; previous]</a></div>
<div class='nav-mid'><a href='#top'>[Top of Page]</a></div>
<div class='nav-mid'><a href='reference.html#top'>[Reference]</a></div>
<div class='nav-right'><a href='_centauri_bash_ext.html'>[next &gt;&gt;]</a></div>
</div></nav>
</body></html>
