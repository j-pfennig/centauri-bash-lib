<!DOCTYPE html>
<html><head><meta charset='UTF-8'></meta>
<title>centaurihelp ─ _centauri_bash_ins</title>
<link rel='stylesheet' type='text/css' href='default.css'></link>
<script type='text/javascript' src='default.js'></script>
</head><body><article id='top'>
<nav><div class='nav-row'>
<div class='nav-left'><a href='_centauri_bash_ext.html'>[&lt;&lt; previous]</a></div>
<div class='nav-mid'><a href='content.html#top'>[Content]</a></div>
<div class='nav-mid'><a href='reference.html#top'>[Reference]</a></div>
<div class='nav-right'><a href='_centauri_bash_iom.html'>[next &gt;&gt;]</a></div>
</div></nav>
<section id='section-1'>
<div id='_centauri_bash_ins' class='item-module'>
<span>Module</span><span> - </span><span>_centauri_bash_ins</span><span> - </span><span><a href="index.html">Centauri Bash Library</a> Installation Helpers</span></div>
<div class='def-row'>
<div class='def-label'>Call:</div>
<div class='def-text'>. <b>_centauri_bash_ins</b></div>
</div>
<div class='def-row'>
<div class='def-label'>Remark:</div>
<div class='def-block'>This module contains no public functions, it provides helpers for module <a href="_centauri_bash_svc.html">_centauri_bash_svc</a> and <a href="_centauri_bash_sys.html">_centauri_bash_sys</a> that are intended for internal use only. These functions are used at library or service installation time. The module also provides some documentation topics.</div>
</div>
<div class='def-row'>
<div class='def-label'>Internal:</div>
<div class='def-text'>_cen_ins_install    (Un)install SysV or systemd service(s)
_cen_ins_service    service setup
_cen_ins_systemd    systemd configuration
_cen_ins_library    NEW library installation
_cen_ins_version    get OS and KDE versions</div>
</div>
<div class='def-row'>
<div class='def-label'>Remark:</div>
<div class='def-block'>Copyright Dr. J. Pfennig (c) 2019-2022</div>
</div>
</section>
<section id='section-2'>
<div id='serviceanddaemon' class='item-topic'>
<span>Topic</span><span> - </span><span>Service and Daemon</span><span> - </span><span>How centauri-bash-library supports Services and Daemons</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The library supports <b>SysV</b> and <b>systemd</b> system services. Services can be installed and removed via <a href="_centauri_bash_sys.html#syssetup">syssetup()</a>, which is implemented as <b>setup</b> verb. Other service verbs are <b>start</b>, <b>stop</b>, <b>restart</b> and <b>status</b>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Additionally <b>daemons</b> are supported. In contrast to a service, a daemon is not installed and can be used without root privileges. Daemons share the <b>start</b>/<b>stop</b> semantics of services. In fact services can be run outside the control of <b>SysV</b> or <b>systemd</b> as stand-alone daemons.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The library simplifies the coding of services, the service script itself contains the neccessary configuration. For <b>systemd</b> the unit file will be autogenerated, optional <b>SysV</b> support needs a <b>LSB-Header</b>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The <b>SysV</b> compatibility mode of <b>systemd</b> is supported. Services having a <b>LSB-Header</b> can be installed as <b>SysV</b> services. Pure <b>SysV</b> should work too.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The documentation contained in this module describes the details:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <a href="#servicetypes">Service Types</a>   - Supported Service Types
  <a href="#serviceconfig">Service Config</a>  - Writing a Service (LSB-Header, Config Variables)
  <a href="#servicesetup">Service Setup</a>   - Installing a Service
  <a href="#systemdconfig">Systemd Config</a>  - Overriding the Configuration of systemd Services</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <a href="#libraryproxy">Library Proxy</a>   - The _centauri_bash_lib Proxy</div>
</div>
</section>
<section id='section-3'>
<div id='servicetypes' class='item-topic'>
<span>Topic</span><span> - </span><span>Service Types</span><span> - </span><span>Supported Service Types</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>Services can show different activation behaviour at start time. The library uses the <b>CEN_SVC_TYPE</b> variable to configure this. The types used are similar to the <b>systemd</b> ServiceType.</div>
</div>
<div class='def-row'>
<div class='def-label'>Instance:</div>
<div class='def-block'><b>systemd</b> runs as a system and as a per-user instance. Services belong either to the system instance or are started per-user. Currently user instances are not supported.</div>
</div>
<div class='def-row'>
<div class='def-label'>Types:</div>
<div class='def-block'>Five execution modes are implemented (for <b>SysV</b> and <b>systemd</b>). These are the valid settings of the <b>CEN_SVC_TYPE</b> variable:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>daemon  cannot be installed as a service, is started like a normal
        program.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>forking SysV legacy; actionStart will fork a separate process. After
        forking actionStart should return. A PIDFile= statement is
        added to the .service file but the PIDFile is not created.
        If actionStart creates one, it is not neccessary to have
        actionStop as systemd (or <a href="_centauri_bash_svc.html">_centauri_bash_svc</a>) send a
        <b>SIGTERM</b> signal to the forked process.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>simple  Under SysV this mode behaves like <b>&quot;forking&quot;</b>. Otherwise
        systemd does the forking. The actionStart code should not
        return before actionStop. No ExecStop= statement is added
        to the .service file, systemd sends a <b>SIGTERM</b> signal. This
        is trapped and causes actionStop to run (if implemented).</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>oneshot Just runs actionStart to do something relatively short. The
        code must return from actionStart. By default actionStop does
        nothing. Adds a RemainAfterExit= statement to the .service
        file. A ExecStop= statement should be used if actionStop
        is implemented.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>once    Like oneshot but no RemainAfterExit= is generated. Such a
        service is no longer running after actionStart returns. No
        actionStop should be implemented.</div>
</div>
<div class='def-row'>
<div class='def-label'>Requirements:</div>
<div class='def-text'>  • use <b>_centauri_bash_lib -v</b> (enables service verbs and help)
  • implement either <a href="_centauri_bash_dbg.html#actionsuser">actions()</a> or <a href="_centauri_bash_dbg.html#runuser">run()</a>
  • the default is <b>CEN_SVC_TYPE</b>=oneshot if <a href="_centauri_bash_dbg.html#actionsuser">actions()</a> is defined
  • the default is <b>CEN_SVC_TYPE</b>=simple if <a href="_centauri_bash_dbg.html#runuser">run()</a> is defined</div>
</div>
</section>
<section id='section-4'>
<div id='serviceconfig' class='item-topic'>
<span>Topic</span><span> - </span><span>Service Config</span><span> - </span><span>Writing a Service (LSB-Header, Config Variables)</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The existence of a <b>SysV</b> header makes a script a <b>SysV</b> service. For <b>systemd</b> a unit file can be auto-generated at installation time.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The service code tries to auto-detect the required service type. This is based on the presence of <a href="_centauri_bash_dbg.html#runuser">run()</a>, <b>actionStart()</b> and <b>actionStop()</b> functions. This happens if <b>CEN_SVC_TYPE</b> is not set or has a value of <b>auto</b>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The <b>CEN_SVC_TYPE</b> variable can be set to overrie auto-detect, see <a href="#servicetypes">Service Types</a>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The service module provides more details on configuration variables, see <a href="_centauri_bash_svc.html">_centauri_bash_svc</a>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Further documentation is provided in the form of templates, see <b>centauriDaemon</b> and <b>centauriService</b>.</div>
</div>
</section>
<section id='section-5'>
<div id='servicesetup' class='item-topic'>
<span>Topic</span><span> - </span><span>Service Setup</span><span> - </span><span>Installing a Service</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>Services have a <b>setup</b> action verb that takes <b>install</b>, <b>uninstall</b> or <b>status</b> as argument. Root rights are needed for most service verbs.</div>
</div>
<div class='def-row'>
<div class='def-label'>SysV:</div>
<div class='def-block'>When <b>systemd</b> is not installed, <b>SysV</b> is used automatically. In the other case <b>SysV</b> compatibility is optional (via LSB-header). The header defines the <b>SysV</b> service dependencies, but these are not used with <b>systemd</b>. If a service has a LSB-header but no <b>CEN_SVC_TYPE</b> value, it will be installed in <b>SysV</b> compatibility mode:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre># Installing &apos;hellosysv&apos; via SysV

&gt; hellosysv setup install

# The library makes a symlink to /etc/init.d/hellosysv and calls insserv
# or systemctl to complete the installation.</pre></div>
</div>
<div class='def-row'>
<div class='def-label'>systemd:</div>
<div class='def-block'>For a <b>systemd</b> service a .service unit can be autogenerated via <b>setup</b>. The value of the variable <b>CEN_SVC_WANTED_BY</b> will end up in a <b>WantedBy</b> in the <b>[Install]</b> section (the default value is <b>multi-user</b>).</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre># Installing a service via systemd

&gt; hellosvc1 setup install

# The library creates /etc/systemd/system/hellosvc1.service and calls
# systemctl to complete the installation.</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>For a more complex configuration a unit file and other custom files can be provided. See <a href="#systemdconfig">systemd Config</a> for details:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre># the custom unit file for service hellosvc2 ($<b>CEN_TOOLS</b>/hellosvc) is
# $<b>CEN_TOOLS</b>/systemd/system/hellosvc2.service

&gt; hellosvc2 setup install

# The library makes a symlink to /etc/systemd/system/hellosvc2.service</pre></div>
</div>
</section>
<section id='section-6'>
<div id='systemdconfig' class='item-topic'>
<span>Topic</span><span> - </span><span>systemd Config</span><span> - </span><span>Support for overriding the systemd configuration</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>To support centauri-bash-lib services, <a href="_centauri_bash_sys.html#syssetup">syssetup()</a> can modify the <b>systemd</b> configuration.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>This is done by making symlinks into <b>/etc/systemd</b>. Although it is possible to have private versions of systemd units, preferrably overrides should be used.</div>
</div>
<div class='def-row'>
<div class='def-label'>Data:</div>
<div class='def-block'>Configuration data is kept in <b>$CEN_TOOLS/systemd/user</b> for user mode services and in <b>$CEN_TOOLS/systemd/system</b> for system mode services. The data in these folders might be:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>(1) Some <b>.service</b> units. Such units are linked into the <b>/etc/systemd</b>
    hierarchie and by default the services are installed and enabled.
(2) Some <b>.target</b> units. They are linked like <b>.service</b> units and
    installed.
(3) Files for <b>.override</b> statements. For them <b>.d</b> folders are created
    and these files are linked into their corresponding folder.
(4) The <b>.wants</b> files belong to target or service units and cause
    the creation of <b>.wants</b> folders. The file contains line by line
    &lt;key&gt; &lt;path&gt; definitions that cause units to be symlinked or
    existing symlinks to be removed from the corresponding folder.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>For installing services and targets no other configuration is needed. When running an uninstall the actions of install are reverted.</div>
</div>
<div class='def-row'>
<div class='def-label'>Wants:</div>
<div class='def-block'>In some cases service dependencies are known in advance and can be implemented using <b>WantedBy</b> statements. When this is not possible, in particular for target units, a folder containing symlinks to unit files is required. The library supports these via <b>.wants</b> files that contain lines in the form &lt;key&gt; &lt;path&gt;. Empty lines and lines starting with <b>#</b> are ignored. The following keys are defined:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'># Links a (dependent) service or target from $<b>CEN_TOOLS</b>
<b>+</b> &lt;service_name&gt;<b>.service</b>
<b>+</b> &lt;service_name&gt;<b>.target</b></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'># Links an external (dependent) service or target
<b>+</b> /&lt;folder&gt;.../&lt;service_name&gt;<b>.service</b>
<b>+</b> /&lt;folder&gt;.../&lt;service_name&gt;<b>.target</b></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'># Removes an existing service or target link
<b>-</b> &lt;service_name&gt;<b>.service</b>
<b>-</b> &lt;service_name&gt;<b>.target</b></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'># Removes an external (dependent) service or target at install
# time and links it again at uninstall. This behaviour is used
# to restore the default behaviour of units after uninstalling
# overrides
<b>!</b> /&lt;folder&gt;.../&lt;service_name&gt;<b>.service</b>
<b>!</b> /&lt;folder&gt;.../&lt;service_name&gt;<b>.target</b></div>
</div>
</section>
<section id='section-7'>
<div id='installation' class='item-topic'>
<span>Topic</span><span> - </span><span>Installation</span><span> - </span><span>Install/Update/Uninstall and Configuration</span></div>
<div class='def-row'>
<div class='def-label'>Install:</div>
<div class='def-block'><a href="_centauri_bash_lib.html">_centauri_bash_lib</a> needs no complex setup program: just unpack the source archive and run one of the included tools with <b>--info install</b>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>Shared installation (needs <b>root</b> rights):</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>arch=<b>&quot;centauri_bash_lib.tgz&quot;</b>        # what to install
dest=<b>&quot;/usr/local/share/centauri&quot;</b>    # where to install (CEN_ROOT)

sudo mkdir <b>-p</b> <b>&quot;$dest&quot;</b>
sudo tar <b>-C</b> <b>&quot;$dest&quot;</b> -xaf <b>&quot;$arch&quot;</b>
sudo <b>&quot;$dest&quot;</b>/tools/centauripaths <b>--info</b> install</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>Private installation (no <b>root</b> rights needed):</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>arch=<b>&quot;centauri_bash_lib.tgz&quot;</b>        # what to install
dest=~/.centauri                    # where to install (CEN_ROOT)

mkdir <b>-p</b> <b>&quot;$dest&quot;</b>
tar <b>-C</b> <b>&quot;$dest&quot;</b> -xaf <b>&quot;$arch&quot;</b>
<b>&quot;$dest&quot;</b>/tools/centauripaths <b>--info</b> install
ln <b>-s</b> <b>&quot;$dest&quot;</b> ~/centauritools
PATH+=<b>&quot;:~/centauritools&quot;</b>            # add this to your ~/.bashrc</pre></div>
</div>
<div class='def-row'>
<div class='def-label'>Non-FHS:</div>
<div class='def-block'>Most Linux systems follow the FSH standard. For other implementations or to install into a non-root FS, the <b>CEN_PATHS</b> array variable is provided. It is initialized by the <a href="#libraryproxy">library proxy</a> to FSH values. The <b>CEN_PREFIX</b> variable can be set to point to a different root folder:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre># to alter the FS root folder (not required for termux, see below)
export <b>CEN_PREFIX</b>=/some/other/root</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>When <b>CEN_PREFIX</b> is not set but <b>PREFIX</b> is non-empty and no <b>&quot;/var&quot;</b> folder is found, _centauri_bash_lib sets <b>CEN_PREFIX</b>=<b>&quot;$PREFIX&quot;</b>. This is used to support termux linux on android. <b>CEN_PREFIX</b> is automatically prepended to <b>CEN_PATHS</b>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre># paths that can be installation dependent (don&apos;t use <b>CEN_PREFIX</b> here):
<b>CEN_PATHS</b>=(<b>&quot;&quot;</b> <b>&quot;/usr/bin&quot;</b> <b>&quot;/etc&quot;</b> <b>&quot;/var&quot;</b> <b>&quot;/tmp&quot;</b>)</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>At <b>_centauri_bash_lib</b> load time, it checks <b>&quot;${CEN_PATHS[1]/bash}&quot;</b>. If this is not executable (e.g. not FSH compliant) the <b>&quot;$BASH&quot;</b> variable is used to get some prefix (path before <b>&quot;/usr/bin&quot;</b> or <b>&quot;/bin&quot;</b>). Using this prefix the library tries to locate <b>&quot;/etc&quot;</b>, <b>&quot;/var&quot;</b> and <b>&quot;/tmp&quot;</b>. The prefix itself is saved to <b>&quot;$CEN_PATHS&quot;</b> (which is identical to <b>&quot;${CEN_PATHS[0]}&quot;</b>).</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The GNU core utilities can be installed either at <b>&quot;$CEN_PATHS/usr/bin&quot;</b> or at <b>&quot;$CEN_PATHS/bin&quot;</b>. The autodetected path is stored as <b>&quot;${CEN_PATHS[1]}&quot;</b>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>To override the autogenerated <a href="#libraryproxy">library proxy</a>, the <b>[proxy]</b> section in the configuration file <b>&quot;centauri-bash-lib&quot;</b> can be used.</div>
</div>
<div class='def-row'>
<div class='def-label'>Customize:</div>
<div class='def-block'>In the example <b>centauripaths</b> is called to trigger a default setup. Before doing so, the configuration can be tailored to local needs by editing the <b>&quot;$CEN_ROOT/tools/_centauri_bash_lib&quot;</b> proxy script.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Installing as non-root user does not need configuration changes. See below for configuration details ...</div>
</div>
<div class='def-row'>
<div class='def-label'>Proxy:</div>
<div class='def-block'>Loading <a href="_centauri_bash_lib.html">_centauri_bash_lib</a> into a user script always invokes a proxy, see <a href="#libraryproxy">Library Proxy</a> for details. This proxy contains some configuration information used to locate the library itself. Every folder containing user scripts wanting to use <a href="_centauri_bash_lib.html">_centauri_bash_lib</a> must contain a symlink to the proxy.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The proxy at <b>$CEN_ROOT/tools</b> is recreated by the installation process. If you are using multiple binary folders symlink the proxy rather than creating copies.</div>
</div>
<div class='def-row'>
<div class='def-label'>Config:</div>
<div class='def-block'>The proxy source is <b>$CEN_ROOT/tools/_centauri_bash_lib</b> and it contains a configuration statement that looks like this:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>export <b>CEN_ROOT_DEF</b>=(<b>&quot;/usr/local/share/centauri&quot;</b> <b>&quot;/usr/local/bin&quot;</b>
                     <b>&quot;/opt/centauri&quot;</b> <b>&quot;root:staff&quot;</b>)</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>This defines a bash array variable with three or four elements (<i>empty</i> stands for a minus sign or an empty string):</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>    [0]     The installation root $<b>CEN_ROOT</b> (should be the path of
            the installation folder)
    [1]     <i>empty</i> -or- folder to symlink user scripts (a folder
            contained in $PATH simplifies calling user scripts).
            This field is ignored if the folder is not writable.
    [2]     <i>empty</i> -or- symlink to <b>$CEN_ROOT/tools</b> (just an
            alias that should be easy to remember). This field is
            ignored if the base folder is not writable.
    [3]     <i>empty</i> or a [user][:group], sets the ownership of created
            folders.</div>
</div>
<div class='def-row'>
<div class='def-label'>Setup:</div>
<div class='def-block'>Parts of the folder tree shown below are added by <a href="_centauri_bash_sys.html">_centauri_bash_sys</a>. An automatic setup of the tree is done on the 1st execution (as root user) if the <b>persistent</b> symlink is missing. The folders for <b>persistent</b> and <b>transient</b> are only of interrest for tools that run as <b>root</b> anyhow:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>$<b>CEN_ROOT</b>
   ├── default     # dynamic, link or folder
   ├── html        # static, documentation
   ├── library     # static, _centauri_bash_lib code
   ├── locale      # static, translations
   ├── persistent  # dynamic, persistent cache
   ├── tools       # static, user scripts ($CEN_TOOLS)
   └── transient   # dynamic, volatile cache</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The tree shown above should be complete after (automatic) setup. The <b>default</b> leaf is a symlink to <b>/etc/default</b> on Debian or a folder of its own otherwise. It can be used for user defined configuration data.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The following commands can be run to force a (repair) setup:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>centauripaths <b>--info</b> install          # setup with prompts
centauripaths <b>--info</b> install <b>--yes</b>    # setup without prompts</pre></div>
</div>
<div class='def-row'>
<div class='def-label'>Updates:</div>
<div class='def-block'>If you add own scripts to the <b>tools</b> folder, symlinks to the binary folder (like <b>/usr/local/bin</b>) are created this way:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>centauripaths <b>--info</b> update           # update binary symlinks</pre></div>
</div>
<div class='def-row'>
<div class='def-label'>Uninstall:</div>
<div class='def-block'>To remove <a href="_centauri_bash_lib.html">_centauri_bash_lib</a> completely type one of those:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>centauripaths <b>--info</b> uninstall        # uninstall with prompt
centauripaths <b>--info</b> uninstall <b>--yes</b>  # uninstall without prompt</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><b>WARNING: uninstall will remove the whole $CEN_ROOT tree.</b></div>
</div>
<div class='def-row'>
<div class='def-label'>Remarks:</div>
<div class='def-block'>As mentioned above, there is no separate installation program. Every script that calls <a href="_centauri_bash_lib.html">_centauri_bash_lib</a> <a href="_centauri_bash_lib.html#main">main()</a> has the <b>--info</b> option and can be used (<b>centauripaths</b> was just used as an example).</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Verbs and options following <b>--info</b> must be typed exactly as documented above. They cannot be abbreviated and must appear in that order.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>To override the default configuration (built into the proxy) create the file <b>$CEN_ROOT/default/centauri-bash-lib</b>, see <a href="_centauri_bash_sys.html#sysconfig">sysconfig()</a>. Some data from the configuration file is compiled into the proxy during setup.</div>
</div>
</section>
<section id='section-8'>
<div id='libraryproxy' class='item-topic'>
<span>Topic</span><span> - </span><span>Library Proxy</span><span> - </span><span>The <a href="index.html">_centauri_bash_lib</a> Proxy</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The library should not be loaded directly, instead a proxy is used. The proxy is generated at installation time and is located at:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <b>$CEN_ROOT/tools/_centauri_bash_lib</b></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>One responsibility of th proxy is to locate the library. This is why it should be sym-linked to <b>&quot;/usr/local/bin&quot;</b>. More details are covered by the <a href="_centauri_bash_doc.html#initialization">Initialization</a> topic.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Also the proxy loads the <a href="_centauri_bash_lib.html">_centauri_bash_lib</a> main module from <b>&quot;$CEN_ROOT/library&quot;</b> and is responsible for setting up a suitable environment. The proxy contains <b>ALL</b> hard configurable library parameters, see <a href="#installation">Installation</a>.</div>
</div>
<div class='def-row'>
<div class='def-label'>Environment:</div>
<div class='def-block'> When loading and if <b>CEN_ROOT</b> is not yet defined, the proxy sets and exports the following variables:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <b>CEN_ROOT</b>            # library root/installation folder
  <b>CEN_LIBRARY</b>         # _centauri_bash_lib modules
  <b>CEN_TOOLS</b>           # centauri tools (or user scripts)
  <b>CEN_PATHS</b>           # an array of paths used by the library
  <b>TMPDIR</b>              # sanitized temp folders ...
  <b>TMP</b></div>
</div>
<div class='def-row'>
<div class='def-label'>Embedding:</div>
<div class='def-block'>When <b>CEN_ROOT</b> is non-empty and has any other value than <b>&quot;.&quot;</b> the library search can be omitted. For setting up <b>CEN_ROOT</b> an expensive call to <b>&quot;/usr/bin/readlink&quot;</b> must be made. This can be avoided by exporting <b>CEN_ROOT</b> from a shell <b>.profile</b>. The same technique is used by <a href="_centauri_bash_lib.html#embed">embed()</a>.</div>
</div>
</section>
<section id='section-9'>
<div id='localization' class='item-topic'>
<span>Topic</span><span> - </span><span>Localization</span><span> - </span><span>Adding support for translations (l10n)</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>Bash and <a href="_centauri_bash_lib.html">_centauri_bash_lib</a> support localization. Translations are implemented using the GNU gettext-tools. A little helper script is provided to simplify the translation process.</div>
</div>
<div class='def-row'>
<div class='def-label'>Setup:</div>
<div class='def-block'>A translated script uses the <b>-t</b> option when loading the library:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>PATH+=<b>&quot;:${0%/*}&quot;</b> . _centauri_bash_lib <b>-t</b> ... <b>&quot;$0&quot;</b> <b>&quot;0.11:1&quot;</b> || exit 2</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Translatable strings are prefixed with a $ (example: $<b>&quot;Hello&quot;</b>).</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Read <b>&quot;$CEN_ROOT/locale/l10n --help&quot;</b> on how to generate the binary translation tables used by bash/GNU gettext. All translation data resides in the following tree:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>$<b>CEN_ROOT</b>
   ├── locale               # translation data
   │   ├── de               # german translations
   │   │   └── <b>LC_MESSAGES</b>  # binaries for gettext
   │   └── ...              # more laguages
   ├── ...                  # other stuff
   └── tools                # user scripts ($CEN_TOOLS)</pre></div>
</div>
</section>
<section id='section-10'>
<div id='pathshortcuts' class='item-topic'>
<span>Topic</span><span> - </span><span>Path Shortcuts</span><span> - </span><span>Shortcuts for filesystem paths</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The library implements a user configurable shortcut system for paths by providing the <a href="_centauri_bash_run.html#shortpath">shortpath()</a> function and the <a href="centauripaths.html">centauripaths</a> tool. Some paths below <b>&quot;$CEN_ROOT&quot;</b> are provided by the library itself. For example:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>shortpath <b>&quot;locale/de&quot;</b> <b>&quot;pers&quot;</b> ; message <b>&quot;${CEN_SHORTPATH[@]}&quot;</b></pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>&gt; centauripaths <b>&quot;loca/de&quot;</b> <b>&quot;persistent&quot;</b></pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>will return <b>&quot;/var/centauri/locale/de&quot;</b> and <b>&quot;/var/centauri/persistent&quot;</b> if <b>CEN_ROOT</b> was set to <b>&quot;/var/centauri&quot;</b> at installation time.</div>
</div>
<div class='def-row'>
<div class='def-label'>Config:</div>
<div class='def-block'>Any number of user defined shortcuts can be added to the search list via <b>&quot;$CEN_ROOT/defaults/centauri_bash_lib&quot;</b>. The following example adds the shortcut <b>&quot;backup&quot;</b> (must be in section <b>&quot;[centauripaths]&quot;</b>):</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>path <b>&quot;backup&quot;</b> <b>&quot;/mnt/backup/Backup|$ROOT/Backup&quot;</b> <b>&quot;Backup volume/folder&quot;</b></pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The 1st argument of <b>&quot;path&quot;</b> is the shotcut name. The 2nd is a list of possible filesystem paths (separated by <b>&quot;|&quot;</b>). The last argument is a textual description. The shortcut will be resolved to the first existing filesystem path.</div>
</div>
</section>
</article>
<div class='def-break'></div>
<nav><div class='nav-row'>
<div class='nav-left'><a href='_centauri_bash_ext.html'>[&lt;&lt; previous]</a></div>
<div class='nav-mid'><a href='#top'>[Top of Page]</a></div>
<div class='nav-mid'><a href='reference.html#top'>[Reference]</a></div>
<div class='nav-right'><a href='_centauri_bash_iom.html'>[next &gt;&gt;]</a></div>
</div></nav>
</body></html>
