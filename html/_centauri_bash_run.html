<!DOCTYPE html>
<html><head><meta charset='UTF-8'></meta>
<title>centaurihelp ─ _centauri_bash_run</title>
<link rel='stylesheet' type='text/css' href='default.css'></link>
<script type='text/javascript' src='default.js'></script>
</head><body onload='initialize("_centauri_bash_run")'><article id='top'>
<nav><div class='nav-row'>
<div class='nav-left'><a href='_centauri_bash_pro.html'>[&lt;&lt; previous]</a></div>
<div class='nav-mid'><a href='content.html#top'>[Content]</a></div>
<div class='nav-mid'><a href='reference.html#top'>[Reference]</a></div>
<div class='nav-right'><a href='_centauri_bash_svc.html'>[next &gt;&gt;]</a></div>
</div></nav>
<section id='section-1'>
<div id='_centauri_bash_run' class='item-module'>
<span>Module</span><span> - </span><span>_centauri_bash_run</span><span> - </span><span><a href="index.html">centauri-bash-lib</a>: Configuration related functions</span></div>
<div class='def-row'>
<div class='def-label'>Call:</div>
<div class='def-text'>. <b>_centauri_bash_run</b></div>
</div>
<div class='def-row'>
<div class='def-label'>Remark:</div>
<div class='def-block'>Functions in this module are related to the <b>&quot;centauri-bash-lib&quot;</b> configuration file and depend on module <a href="_centauri_bash_iom.html">_centauri_bash_iom</a>, see <a href="_centauri_bash_iom.html#configfile">configfile()</a>.</div>
</div>
<div class='def-row'>
<div class='def-label'>Functions:</div>
<div class='def-block'>This module implements these public functions:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <a href="#launcher">launcher()</a>   Run an external application using a generic name
  <a href="#shortpath">shortpath()</a>  Resolve shortcut names for file system paths
  <a href="#terminal">terminal()</a>   Run a terminal emulator if needed</div>
</div>
<div class='def-row'>
<div class='def-label'>Variables:</div>
<div class='def-block'>The following public variables are used:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <b>CEN_DESKTOP</b>     current desktop or &apos;tty&apos; if no desktop is detected
  <b>CEN_LAUNCHER</b>    default result variable of <a href="#launcher">launcher()</a>
  <b>CEN_SHORTPATH</b>   default result variable of <a href="#shortpath">shortpath()</a>
  <b>CEN_TERMINAL</b>    default result variable of <a href="#terminal">terminal()</a></div>
</div>
<div class='def-row'>
<div class='def-label'>Remarks:</div>
<div class='def-block'>Copyright Dr. J. Pfennig (c) 2022</div>
</div>
</section>
<section id='section-2'>
<div id='libraryconfiguration' class='item-topic'>
<span>Topic</span><span> - </span><span>Library configuration</span><span> - </span><span>The <a href="index.html">centauri-bash-lib</a> configuration file</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>In addition to built-in data some library functions can use information configured in the optional file <b>&quot;centauri-bash-lib&quot;</b> at folder <b>&quot;$CEN_ROOT/default&quot;</b>. The file uses INI style syntax, e.g. is organized into sections. Empty lines and comments are ignored. Most of the data gets cached at run time, so feel free to use comments for documentation.</div>
</div>
<div class='def-row'>
<div class='def-label'>Sections:</div>
<div class='def-block'>All sections are optional and may be missing or empty.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  • [shortpath]   for <a href="#shortpath">shortpath()</a> and <a href="centauripaths.html">centauripaths</a>, see <a href="#shortpathconfig">shortpath Config</a>
  • [launcher]    for <a href="#launcher">launcher()</a> and <a href="centaurilauncher.html">centaurilauncher</a>, see <a href="#launcherconfig">launcher Config</a>
  • [terminal]    for <a href="#terminal">terminal()</a> and <a href="centaurilauncher.html">centaurilauncher</a>, see <a href="#terminalconfig">terminal Config</a>
  • [library]     miscellaneous data, see <a href="_centauri_bash_ext.html#prettypath">prettypath</a> and <a href="_centauri_bash_ins.html#installation">Installation</a>
  • [proxy]       script code added to the proxy, see <a href="_centauri_bash_ins.html#libraryproxy">Library Proxy</a></div>
</div>
<div class='def-row'>
<div class='def-label'>Remark:</div>
<div class='def-block'>Any extra sections can be added for local needs. See <a href="_centauri_bash_iom.html#configfile">configfile</a> for details on how to process configuration files.</div>
</div>
<div class='def-row'>
<div class='def-label'>Examples:</div>
<div class='def-text'>(1) A simple configuration for use with Termux (Linux on Android):</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>[library]
    # installation defaults (root, binaries, shortcut, repository, owner)
    defaults    private  $HOME/.centauri $HOME/bin $HOME/centauritools
    defaults    shared   /var/centauri /usr/local/bin /opt/centauritools

[launcher]
    # desktop apps (- is for any desktop session, must be last)
    editor      -       kwrite featherpad
    files       -       dolphin
    browser     -       firefox falkon qml
    kiosk       -       qml falkon firefox
    console     -       @terminal
    httpd       -       lighttpd

    # terminal apps (tty is for non-desktop mode)
    editor      tty     nano vim
    files       tty     mc
    browser     tty     w3m

    # qml needs a few hints (@_cen_win_qmlweb creates the qml script)
    -ignore:qml         qtchooser
    -path:qml           /usr/lib/*/qt5/bin/qml
    browser:qml         @launcher_qmlweb 1024 768 1.2
    kiosk:qml           @launcher_qmlweb  1000 800 1.2
    httpd:lighttpd      @launcher_httpd 8080 /var/www

    # command line args
    kiosk:firefox       <b>--fullscreen</b> <b>--new</b>-window
    browser:firefox     <b>--new</b>-window

    kiosk:falkon        <b>--fullscreen</b> <b>--new</b>-window <b>--no</b>-extensions
    browser:falkon      <b>--new</b>-window <b>--no</b>-extensions

    # info text for apps (not commands)
    info:editor         text editor
    info:files          file manager
    info:browser        web browser
    info:kiosk          web browser in kiosk mode
    info:console        command line terminal
    info:httpd          launch a private web server

[terminal]
    # emulators for KDE/Gnome sessions:
    emulator    kde     konsole qterminal gnome-terminal xterm
    emulator    gnome   gnome-terminal konsole qterminal xterm
    # other session types (must be last emulator line):
    emulator    -       qterminal gnome-terminal konsole  xterm

    # options for emulator apps
    -args:konsole       <b>--hide</b>-tabbar <b>--hide</b>-menubar <b>--nofork</b>
    -title:konsole      <b>--title</b>

    -args:gnome-terminal  <b>--hide</b>-menubar <b>--wait</b> <b>--</b>
    -title:gnome-terminal <b>--title</b>

    -args:xterm         -fa Monospace -fs 14 -geometry 100x30

    # in many cases we don&apos;t need to run an emulator, so we check our ancestors until
    # we find something blacklisted (start emulator) or whitelisted (no emulator):

    # no emulator if we find a login shell
    login               -bash|-dash|-csh|-sh
    # continue search if ancestor is a shell
    shell               bash|dash|csh|sh
    # no emulator for these ...
    white               sudo|kdeinit.*\ konsole.*|konsole.*|gnome.*|qterminal|xterm
    # needing to launch emulator ...
    black               krunner.*|lx.*-session|plasma.*
    # no desktop, no xroot
    black-startup       sddm.*|startkde.*|startplasma.*

[shortpath]
    # These are examples of shortcuts for centauripaths (alias ccd)
    path <b>&quot;export&quot;</b>    <b>&quot;$/export&quot;</b>                   <b>&quot;Export Folder&quot;</b>
    path <b>&quot;docs&quot;</b>      <b>&quot;$/usr/share/doc&quot;</b>            <b>&quot;Linux Documentation&quot;</b>
    path <b>&quot;bin&quot;</b>       <b>&quot;${CEN_PATHS[1]}&quot;</b>            <b>&quot;Linux Anwendungen&quot;</b>
    path <b>&quot;etc&quot;</b>       <b>&quot;${CEN_PATHS[2]}&quot;</b>            <b>&quot;Linux Konfiguration&quot;</b>
    path <b>&quot;docs&quot;</b>      <b>&quot;/share/doc|/usr/share/doc&quot;</b>  <b>&quot;Linux Dokumentation&quot;</b>

    path <b>&quot;android&quot;</b>   <b>&quot;$HOME/storage&quot;</b>              <b>&quot;Android gemeinsamer Speicer&quot;</b>

    path <b>&quot;export&quot;</b>    <b>&quot;$HOME/storage/shared/export&quot;</b>         <b>&quot;Export Verzeichnis&quot;</b>
    path <b>&quot;bilder&quot;</b>    <b>&quot;$HOME/storage/shared/export/Bilder&quot;</b>  <b>&quot;Bilder (in export)&quot;</b>
    path <b>&quot;musik&quot;</b>     <b>&quot;$HOME/storage/shared/export/Musik&quot;</b>   <b>&quot;Musik  (in export)&quot;</b>
    path <b>&quot;rezepte&quot;</b>   <b>&quot;$HOME/storage/shared/export/Rezepte&quot;</b> <b>&quot;Kochrezepte&quot;</b></pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>(2) A more complex config for a native Linux system:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>[shortpath]
        # ...
[launcher]
        # ...
[terminal]
        # ...
[library]
    defaults shared  <b>&quot;/var/centauri&quot;</b> <b>&quot;/usr/local/bin&quot;</b> <b>&quot;/admin&quot;</b> \
                     <b>&quot;/var/centauri/admin&quot;</b> <b>&quot;root:staff&quot;</b>
    defaults private $HOME/.centauri $HOME/bin $HOME/centauritools
    include <b>&quot;utilities/show-unattended-upgrades&quot;</b> <b>&quot;virtualbox/vbox&quot;</b>
    exclude <b>&quot;&quot;</b>
    obsolete <b>&quot;centaurigencfg&quot;</b> <b>&quot;centaurisync&quot;</b>
    service <b>&quot;centauriswitch&quot;</b> <b>&quot;centauriroute&quot;</b>
    repath <b>-l</b> <b>&quot;/dev/shm(/.*)?&quot;</b> <b>&quot;/tmp%1&quot;</b></pre></div>
</div>
</section>
<section id='section-3'>
<div id='launcherconfig' class='item-topic'>
<span>Topic</span><span> - </span><span>launcher Config</span><span> - </span><span>Section in <a href="index.html">centauri-bash-lib</a> configuration file</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The <a href="#launcher">launcher()</a> function reads the (cached) configuration statements to find an executable command (or a function) for a generic name.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'><b>&quot;$CEN_ROOT/default&quot;</b> is the preferred location for <b>&quot;centauri-bash-lib&quot;</b>, see <a href="_centauri_bash_iom.html#configfile">configfile()</a> for more details.</div>
</div>
<div class='def-row'>
<div class='def-label'>Config:</div>
<div class='def-block'>Valid <b>&quot;centauri-bash-lib&quot;</b> configuration lines are:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'># potential real commands for a generic name
  <i>what</i>               <i>desk</i> @<i>func</i>|<i>tool</i>...
# set options and arguments of a command to be run
  <i>what</i><b>:</b><i>tool</i>          <i>arg</i>...
# command is run by a function
  <i>what</i><b>:</b><i>tool</i>          @<i>func</i> <i>arg</i>...
# optional: command not found if sym-linked to <i>nogo</i>
  <b>-ignore:</b><i>tool</i>       <i>nogo</i>
# optional: short commad description
  <b>-info:</b><i>tool</i>         <i>text</i>
# optional: any kind of flags (not used by launcher)
  <b>-flag:</b><i>tool</i>         <i>arg</i>...
# optional: explicit path(s) of a command
  <b>-path:</b><i>tool</i>         <i>path</i>...</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>Where place holders are defined as:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <i>what</i>          generic command name
  <i>desk</i>          desktop type filter
  <i>tool</i>          is a command name (not a path)
  <i>arg</i>           any kind of argument
  <i>func</i>          call a (user script) function to run <i>what</i>
  <i>path</i>          file system path, bash globbing allowed
  <i>nogo</i>          sym link destination (example: <b>qtchooser</b>)
  <i>text</i>          short command description</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>Configuration Example:<pre>        [launcher]
            # desktop apps (- is for any desktop session, must be last)
            editor      -       kwrite featherpad
            browser     -       unfug firefox falkon qml
            kiosk       -       qml falkon sauwetter firefox
            terminal    -       @terminal quarkteig

            # terminal apps (tty is for non-desktop mode)
            editor      tty     nano vim
            browser     tty     w3m

            # qml needs some care (@launcher_qmlweb creates the qml script)
            -ignore:qml         qtchooser
            -path:qml           /usr/lib/*/qt5/bin/qml
            browser:qml         @launcher_qmlweb 1024 768 1.2
            kiosk:qml           @launcher_qmlweb 1000 800 1.2

            # command line args
            kiosk:firefox       <b>--fullscreen</b> <b>--new</b>-window
            browser:firefox     <b>--new</b>-window
            kiosk:falkon        <b>--fullscreen</b> <b>--new</b>-window <b>--no</b>-extensions
            browser:falkon      <b>--new</b>-window <b>--no</b>-extensions

            # info text for generic names (not commands)
            info:editor         text editor
            info:browser        web browser
            info:kiosk          web browser in kiosk mode
            info:terminal       terminal emulator</pre></div>
</div>
</section>
<section id='section-4'>
<div id='launchercallback' class='item-function'>
<span>Function</span><span> - </span><span>launcher (callback)</span><span> - </span><span>Implementing a user defined command</span></div>
<div class='def-row'>
<div class='def-label'>Call:</div>
<div class='def-text'><i>func</i> <i>option</i>.. <b>--</b> <i>arg</i>...</div>
</div>
<div class='def-row'>
<div class='def-label'>Options:</div>
<div class='def-text'><b>-f</b>  error are fatal
<b>-i</b>  information string
<b>-m</b>  lauch per exec or in background
<b>-o</b>  override desktop status (force running emulator)
<b>-q</b>  no error messages
<b>-r</b>  ignore <b>--dryrun</b>
<b>-t</b>  window title
<b>-x</b>  query if command can be run (args: <i>cmd</i> &lt;arg...&gt;)
<b>-y</b>  session type override</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The function must ignore all non-option words and all unspecified options before the &apos;<b>--</b>&apos; separator.</div>
</div>
<div class='def-row'>
<div class='def-label'>Example:</div>
<div class='def-text'><pre>launcher_my_command() {
    local oerr oinf over orun otit mode desk
    while [ $# -gt 0 ] ; do
    case <b>&quot;$1&quot;</b> in
        <b>--</b>)   shift ; break ;;
        <b>-f</b>)   oerr=&apos;<b>-f</b>&apos; ;;
        <b>-i</b>)   shift ; oinf=<b>&quot;$1&quot;</b> ;;      # not used in this example
        <b>-m</b>)   shift ; mode=<b>&quot;$1&quot;</b> ;;      # not used in this example
        <b>-o</b>)   shift ; over=<b>&quot;$1&quot;</b> ;;      # not used in this example
        <b>-q</b>)   oerr=&apos;<b>-q</b>&apos; ;;
        <b>-r</b>)   orun=&apos;<b>-r</b>&apos; ;;
        <b>-t</b>)   shift ; otit=<b>&quot;$1&quot;</b> ;;
        <b>-x</b>)   ochk=1 ;;
        <b>-y</b>)   shift ; desk=<b>&quot;$1&quot;</b> ;;      # not used in this example
        *)    continue
        esac ; shift
    done

    # option -x: check if executable and return status
    if [ <b>-n</b> <b>&quot;$ochk&quot;</b> ] ; then
        sysfind <b>-q</b> <b>-c</b> <b>--</b> &apos;my-command&apos; || return 1
    # run the command
    else
        system $oeff $orun <b>--</b> &apos;my-command&apos; <b>--tile</b> <b>&quot;$otit&quot;</b> <b>&quot;$@&quot;</b> || return 1
    fi
    return 0
}</pre></div>
</div>
</section>
<section id='section-5'>
<div id='launcher' class='item-function'>
<span>Function</span><span> - </span><span>launcher</span><span> - </span><span>Run an external application using a generic name</span></div>
<div class='def-row'>
<div class='def-label'>Call:</div>
<div class='def-text'>(1) <b>launcher</b> [<b>-f</b>|<b>-q</b>] [<b>-m</b> <i>mode</i>] [<b>-t</b> <i>titl</i>] <b>-o</b> <i>desk</i> [<b>--</b>] <i>what</i> <i>arg</i>...
(2) <b>launcher</b> [<b>-f</b>|<b>-q</b>] [<b>-t</b> <i>titl</i>] <b>-n</b> <b>-o</b> <i>desk</i> <b>-a</b> <i>rslt</i> [<b>--</b>] <i>what</i> <i>arg</i>...
(3) <b>launcher</b> [<b>-f</b>|<b>-q</b>] <b>-l</b> <i>lsel</i> <b>-o</b> <i>desk</i> <b>-a</b> <i>rslt</i>
(4) <b>launcher</b> <b>-x</b> [<b>-m</b> <i>mode</i>] [<b>-t</b> <i>title</i>] [<b>-y</b> <i>desk</i>] <i>opt</i>... <b>--</b> <i>arg</i>...</div>
</div>
<div class='def-row'>
<div class='def-label'>Options:</div>
<div class='def-text'><b>-a</b>  array of resulting command words (default is <b>CEN_LAUNCHER</b>)
<b>-f</b>  errors are fatal
<b>-i</b>  information string passed to callback
<b>-l</b>  [*] get application list
<b>-m</b>  launch via exec or in background
<b>-n</b>  [*] do not run, return command array
<b>-q</b>  no error messages
<b>-r</b>  ignore <b>--dryrun</b>
<b>-t</b>  window title (supported by <a href="#terminal">terminal()</a> and callback)
<b>-x</b>  run a command or function via system()
<b>-y</b>  override session type</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>[*] these options are mutually exclusive</div>
</div>
<div class='def-row'>
<div class='def-label'>Arguments:</div>
<div class='def-text'><i>arg</i>   arguments to be passed to the application
<i>lsel</i>  0:all  1:session  2:executable
<i>mode</i>  0:just run   1:exec   2:background   3:disown
<i>rslt</i>  variable name, receives returned data as array
<i>desk</i>  <b>&quot;tty&quot;</b>, <b>&quot;kde&quot;</b>, <b>&quot;lxqt&quot;</b>, ... (see $<b>XDG_SESSION_DESKTOP</b>)
<i>titl</i>  window title text
<i>what</i>  generic name for a command like <b>&quot;browser&quot;</b> or <b>&quot;editor&quot;</b></div>
</div>
<div class='def-row'>
<div class='def-label'>Return:</div>
<div class='def-text'><b>true</b> at success or <b>false</b> otherwise.</div>
</div>
<div class='def-row'>
<div class='def-label'>Remarks:</div>
<div class='def-block'>This function can select and run an application depending on session type and installation status. It depends on configuration entries in <b>&quot;centauri-bash-lib&quot;</b> section <b>&quot;[launcher]&quot;</b>, see <a href="#launcherconfig">launcher config</a>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>If the <b>launcher</b> configuration calls an argument function or a command function, the final call passes options <b>-f</b> <b>-i</b> <b>-m</b> <b>-q</b> <b>-r</b> <b>-t</b> and <b>-y</b> to the function, see <a href="#launchercallback">launcher (callback)</a>.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Form (1) searches a matching command and runs it. Form (2) does not run the command, but returns the command (as an array of words). The configuration <b>&quot;-args:&lt;command&gt;&quot;</b> line is expanded via <b>eval</b> to unquote words (single quotes must be escaped, variable substitutions may work).</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Form (3) can be used to get a list of commands. The list entries are made up of four or five fields: <i>what</i> <i>desk</i> <i>path</i>|<i>tool</i>... <i>info</i> [<i>flag</i>] . The fields are delimited by <b>&quot;\a&quot;</b>. The <i>tool</i>... names are separated by spaces (as in the config line). The <i>flag</i> field is only present for <b>-flag:</b><i>what</i> statements.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Form (4) is used to run a command or function, typically from inside a <b>launcher</b> function.</div>
</div>
<div class='def-row'>
<div class='def-label'>Examples:</div>
<div class='def-text'>(1) Launch browser as independent process<pre><b>launcher</b> <b>-m</b> 3 <b>--</b> browser || quit <b>-e</b> - <b>&quot;failed to run browser&quot;</b>
local bpid=$!
if kill -0 $bpid 2&gt;/dev/null ; then
    message <b>&quot;Browser is running (PID=$bpid)&quot;</b>
else
    message <b>&quot;Browser has stopped&quot;</b>
fi</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>(2) Get a list of configured applications<pre><b>launcher</b> <b>-l</b> 0
local item flds
for item in <b>&quot;${CEN_LAUNCHER[@]}&quot;</b> ; do
    splitjoin <b>-s</b> flds <b>-d</b> $&apos;\a&apos; <b>--</b> <b>&quot;$item&quot;</b>
    printf <b>&quot;%-12s  %-6s  %-40s  %s\n&quot;</b> <b>&quot;${flds[@]::4}&quot;</b>
done</pre></div>
</div>
</section>
<section id='section-6'>
<div id='shortpathconfig' class='item-topic'>
<span>Topic</span><span> - </span><span>shortpath Config</span><span> - </span><span>Section in <a href="index.html">centauri-bash-lib</a> configuration file</span></div>
<div class='def-row'>
<div class='def-label'>Format:</div>
<div class='def-block'>The <a href="#shortpath">shortpath()</a> function reads the (cached) configuration statements. A shortcut is a short name that is resolved to the path of an existing folder. Multiple destination paths per shortcut can be given in a list and the 1st existing path is used.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Each shortcut definition is stored as a text line made of the literal word <b>path</b> followed by three fields of (quoted) text that are separated by spaces (e.g. the fields are bash words):</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <i>shortcut</i> := <b>path</b> <i>name</i> <b>&quot;</b><i>paths</i><b>&quot;</b> <b>&quot;</b><i>info</i><b>&quot;</b></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>No <b>&quot;:&quot;</b> characters must appear in <i>name</i> or <i>paths</i> fields, they are internally used as field delimiters. The list of paths can contain any number of paths separated by <b>&quot;|&quot;</b> characters:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <i>paths</i> := <i>path</i> [ <b>|</b> <i>path</i> ] ...</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Extra spaces are not allowed. Spaces and single quotes must be escaped like &quot;\ <b>&quot; and &quot;</b>\&apos;&quot;. The lines are passed through bash <b>eval</b> and can contain variables. <b>&quot;~&quot;</b> expansion also works.</div>
</div>
<div class='def-row'>
<div class='def-label'>Example:</div>
<div class='def-text'><pre>[shortpath]
   path disk       <b>&quot;/mnt/backup/disk|$BACKUPS/disk&quot;</b> <b>&quot;folder for disk archives&quot;</b>
   path data       <b>&quot;/mnt/backup/data|$BACKUPS/data&quot;</b> <b>&quot;folder for data archives&quot;</b>
   path phys       <b>&quot;/mnt/backup/phys|$BACKUPS/phys&quot;</b> <b>&quot;folder for disk images&quot;</b></pre></div>
</div>
<div class='def-row'>
<div class='def-label'>Builtin:</div>
<div class='def-block'>Some predefined entries are provided by the library iself</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>   path root       <b>&quot;$CEN_ROOT&quot;</b>              <b>&quot;centauritools installation root&quot;</b>
   path library    <b>&quot;$CEN_LIBRARY&quot;</b>           <b>&quot;centauri-bash-lib library files&quot;</b>
   path tools      <b>&quot;$CEN_TOOLS&quot;</b>             <b>&quot;centauritools applications&quot;</b>
   path locale     <b>&quot;$CEN_ROOT/locale&quot;</b>       <b>&quot;centauritools/library translations&quot;</b>
   path default    <b>&quot;$CEN_ROOT/default|${CEN_PATHS[2]}/default&quot;</b>  <b>&quot;config files&quot;</b>
   path persistent <b>&quot;$CEN_ROOT/persistent|${CEN_PATHS[4]}&quot;</b>       <b>&quot;persistent cache&quot;</b>
   path transient  <b>&quot;$CEN_ROOT/transient|${CEN_PATHS[4]}&quot;</b>        <b>&quot;volatile cache&quot;</b>
   path temporary  <b>&quot;$XDG_RUNTIME_DIR|${CEN_PATHS[4]}|$TMPDIR&quot;</b>   <b>&quot;user tmp folder&quot;</b></pre></div>
</div>
</section>
<section id='section-7'>
<div id='shortpath' class='item-function'>
<span>Function</span><span> - </span><span>shortpath</span><span> - </span><span>Resolve shortcut names for file system paths</span></div>
<div class='def-row'>
<div class='def-label'>Call:</div>
<div class='def-text'><b>shortpath</b> [<b>-q</b>] [<b>-f</b>] [<b>-e</b>] [<b>-g</b>] [<b>-a</b> <i>rslt</i>] [<b>-n</b> <i>ndir</i>]
<b>shortpath</b> ... [<b>-r</b>] <b>-m</b> <i>part</i>                  # get matching data
<b>shortpath</b> ... [<b>-r</b>] <i>name</i>...                  # get exact matches</div>
</div>
<div class='def-row'>
<div class='def-label'>Arguments:</div>
<div class='def-text'><i>name</i>  a logical path name (shortcut)
<i>ndir</i>  <b>dash</b>    add a &apos;-&apos; to result list
      <b>empty</b>   add empty entry (default for option <b>-m</b>)
      <b>ignore</b>  skip this item, do not report as error
      <b>path</b>    add the 1st defined path to result list
<i>part</i>  a prefix to be searched in data
<i>rslt</i>  result array or variable to be set (default: <b>CEN_SHORTPATH</b>)</div>
</div>
<div class='def-row'>
<div class='def-label'>Options:</div>
<div class='def-text'><b>-a</b>  result array or variable
<b>-e</b>  generate error messages on query operations
<b>-f</b>  make errors fatal
<b>-g</b>  ignore unknown shortcut names
<b>-m</b>  match prefix, search shortcut table
<b>-n</b>  folder-not-present action, see <i>ndir</i>
<b>-q</b>  do not report problems in config/cache handling
<b>-r</b>  return raw string, not a path</div>
</div>
<div class='def-row'>
<div class='def-label'>Return:</div>
<div class='def-text'><b>true</b> at success or <b>false</b> otherwise.</div>
</div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The library implements a user configurable shortcut system for paths by providing the <a href="#shortpath">shortpath()</a> function and the <a href="centauripaths.html">centauripaths</a> tool. Some paths below <b>&quot;$CEN_ROOT&quot;</b> are provided by the library itself. For example:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre><b>shortpath</b> <b>&quot;locale/de&quot;</b> <b>&quot;pers&quot;</b> ; message <b>&quot;${CEN_SHORTPATH[@]}&quot;</b></pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>&gt; centauripaths <b>&quot;loca/de&quot;</b> <b>&quot;persistent&quot;</b></pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>will return <b>&quot;/var/centauri/locale/de&quot;</b> and <b>&quot;/var/centauri/persistent&quot;</b> if <b>CEN_ROOT</b> was set to <b>&quot;/var/centauri&quot;</b> at installation time.</div>
</div>
<div class='def-row'>
<div class='def-label'>Config:</div>
<div class='def-block'>Any number of user defined shortcuts can be added to the search list via <b>&quot;$CEN_ROOT/defaults/centauri_bash_lib&quot;</b>. The following example adds the shortcut <b>&quot;backup&quot;</b> (must be in section <b>&quot;[centauripaths]&quot;</b>):</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>path <b>&quot;backup&quot;</b> <b>&quot;/mnt/backup/Backup|$ROOT/Backup&quot;</b> <b>&quot;Backup volume/folder&quot;</b></pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The 1st argument of <b>&quot;path&quot;</b> is the shotcut name. The 2nd is a list of possible filesystem paths (separated by <b>&quot;|&quot;</b>). The last argument is a textual description. The shortcut will be resolved to the first existing filesystem path.</div>
</div>
<div class='def-row'>
<div class='def-label'>Remark:</div>
<div class='def-block'>The function loops over a (chached) list of shorcut definition lines. These are loaded at 1st call from <b>&quot;centauri-bash-lib&quot;</b> section <b>&quot;[shortpath]&quot;</b>. The format is described at <a href="#shortpathconfig">shortpath config</a>. Each shortcut can have a list of paths and the 1st path specifying an existing folder becomes the resulting path.</div>
</div>
<div class='def-row'>
<div class='def-label'>Examples:</div>
<div class='def-text'>(1) get some paths from (abbreviated) shortcuts<pre><b>shortpath</b> <b>-a</b> rslt <b>--</b> default persi transient</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>(2) like (1) but tolerate unknown shortcuts<pre><b>shortpath</b> <b>-a</b> rslt <b>-g</b> <b>--</b> default unknown transient</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>(3) load the configuration data and return raw array<pre><b>shortpath</b> <b>-f</b> <b>-q</b> <b>-a</b> rslt <b>-r</b> <b>-m</b> <b>&quot;&quot;</b>
<b>shortpath</b> <b>-f</b> <b>-q</b> <b>-a</b> part <b>-r</b> <b>-m</b> <b>&quot;auto&quot;</b></pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>(4) resolve shortcut, check if unique<pre><b>shortpath</b> <b>-g</b> <b>-n</b> ignore <b>-m</b> <b>&quot;$part&quot;</b>
case <b>&quot;${#CEN_SHORTPATH[@]}&quot;</b> in
    0)  message <b>&quot;Shortcut &apos;$part&apos; has no path&quot;</b> ;;
    1)  message <b>&quot;Shortcut &apos;$part&apos; is &apos;$CEN_SHORTPATH&apos;&quot;</b> ;;
    *)  error <b>&quot;Shortcut &apos;$part&apos; is ambiguous&quot;</b>
esac</pre></div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>(5) list existing shortcuts
<b>shortpath</b> <b>-m</b> <b>&quot;&quot;</b> <b>-n</b> <b>&quot;dash&quot;</b> ; splitjoin <b>-i</b> <b>CEN_SHORTPATH</b></pre></div>
</div>
</section>
<section id='section-8'>
<div id='terminalconfig' class='item-topic'>
<span>Topic</span><span> - </span><span>terminal Config</span><span> - </span><span>Section in <a href="index.html">centauri-bash-lib</a> configuration file</span></div>
<div class='def-row'>
<div class='def-label'>General:</div>
<div class='def-block'>The <a href="#terminal">terminal()</a> function reads the (cached) configuration statements to find an executable command to be run as a console emulator.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'><b>&quot;$CEN_ROOT/default&quot;</b> is the preferred location for <b>&quot;centauri-bash-lib&quot;</b>, see <a href="_centauri_bash_iom.html#configfile">configfile</a> for more details.</div>
</div>
<div class='def-row'>
<div class='def-label'>Config:</div>
<div class='def-block'>Valid <b>&quot;centauri-bash-lib&quot;</b> configuration lines are:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'># potential emulator commands
  <b>emulator</b>           <i>desk</i> <i>tool</i>...
# optional: emulator tool configuration
  <b>-args:</b><i>tool</i>         <i>arg</i>...
  <b>-flags:</b><i>tool</i>        <i>arg</i>...
  <b>-title:</b><i>tool</i>        <i>arg</i>...
# no emulator if we find a login shell
  <b>login</b>              <i>arg</i>...
# continue search if ancestor is a shell
  <b>shell</b>              <i>arg</i>...
# need no emulator for these parents ...
  <b>white</b>              <i>arg</i>...
# needing to launch emulator ...
  <b>black</b>              <i>arg</i>...
        # no desktop, no xroot
  <b>black-startup</b>      <i>arg</i>...
        # embedded konsole, check KONSOLE_DBUS_SERVICE
  <b>black-konsole</b>      <i>arg</i>...</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>Where place holders are defined as:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  <i>tool</i>          is a command name (not a path)
  <i>arg</i>           any kind of argument</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>Configuration Example:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre>[terminal]
    # emulators for KDE/Gnome desktop sessions:
    emulator     kde     konsole qterminal gnome-terminal xterm
    emulator     gnome   gnome-terminal konsole qterminal xterm
    # other session types (must be last emulator line):
    emulator     -      qterminal gnome-terminal konsole  xterm

    # options for emulators
    -args:konsole       <b>--hide</b>-tabbar <b>--hide</b>-menubar <b>--nofork</b>
    -title:konsole      <b>--title</b>
    -args:gnome-terminal    <b>--hide</b>-menubar <b>--wait</b> <b>--</b>
    -title:gnome-terminal   <b>--title</b>

    # configure desktop state detection
    login               -bash|-dash|-csh|-sh
    shell               bash|dash|csh|sh
    white               sudo|kdeinit.*\ konsole.*|konsole.*|gnome.*|qterminal|xterm
    black               krunner.*|lx.*-session|plasma.*
    black-startup       sddm.*|startkde.*|startplasma.*
    black-konsole       dolphin.*|kde.*</pre></div>
</div>
</section>
<section id='section-9'>
<div id='terminal' class='item-function'>
<span>Function</span><span> - </span><span>terminal</span><span> - </span><span>Run a terminal emulator if needed</span></div>
<div class='def-row'>
<div class='def-label'>Call:</div>
<div class='def-text'>(1) <b>terminal</b> [<b>-c</b>|<b>-x</b>] [<b>-f</b>|<b>-q</b>] [<b>-o</b> <i>over</i>] [<b>-y</b> <i>desk</i>]
(2) <b>terminal</b> [<b>-f</b>|<b>-q</b>] [<b>-m</b> <i>mode</i>] [<b>-o</b> <i>over</i>] [<b>-t</b> <i>titl</i>] [<b>-y</b> <i>desl</i>] [<b>--</b>] <i>arg</i>...</div>
</div>
<div class='def-row'>
<div class='def-label'>Options:</div>
<div class='def-text'><b>-a</b>  array of resulting command words (default is <b>CEN_TERMINAL</b>)
<b>-b</b>
<b>-c</b>  force check if a <b>terminal</b> emulator must be run
<b>-f</b>  error are fatal
<b>-m</b>  lauch per exec or in background
<b>-n</b>  do not run, only return command array
<b>-o</b>  override desktop status (force running emulator)
<b>-q</b>  no error messages
<b>-r</b>  ignore <b>--dryrun</b>
<b>-t</b>  window title (if supported by emulator)
<b>-x</b>  check if a <b>terminal</b> emulator can be run
<b>-y</b>  desktop type override</div>
</div>
<div class='def-row'>
<div class='def-label'>Arguments:</div>
<div class='def-text'><i>arg</i>   arguments passed to emulator via <b>&quot;&lt;tool&gt; -e &lt;arg&gt;...&quot;</b>
<i>desk</i>  desktop config to use like: tty kde lxqt gnome
<i>mode</i>  0:wait (default)  1:exec  2:background  3:disown
<i>titl</i>  window title
<i>over</i>  0:auto (default)  1:start  2:no start</div>
</div>
<div class='def-row'>
<div class='def-label'>Return:</div>
<div class='def-text'><b>true</b> at success or <b>false</b> otherwise.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>The following variables are set:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>  • <b>CEN_IS_DESKTOP</b>        desktop status, see below
  • <b>CEN_RUN_EMULATOR</b>      used <b>terminal</b> emulator like <b>&quot;/usr/bin/konsole&quot;</b>
  • <b>CEN_TERMINAL</b>          command to be executed</div>
</div>
<div class='def-row'>
<div class='def-label'>Remarks:</div>
<div class='def-block'>The main pupose of this function is to find out if a desktop is active and if the caller is running in a terminal emulator window. Depending on this the following happens:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>    Desktop running, no emulator: start an emulator
    No desktop or in an emulator: simply execute</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>Common terminal emulators are: <b>konsole</b>, <b>qterminal</b> or <b>gnome-terminal</b>. The emulator detection process and the emulator to be started can be configured, see below.</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>The variable <b>CEN_IS_DESKTOP</b> is set on the first call or if option <b>-c</b> is passed:</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'>    <b>CEN_IS_DESKTOP</b>=       # state unknown, will check
    <b>CEN_IS_DESKTOP</b>=0      # no desktop or in emulator
    <b>CEN_IS_DESKTOP</b>=1      # have desktop need emulator
    <b>CEN_IS_DESKTOP</b>=2      # have no desktop but need emulator</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-block'>All common <b>terminal</b> emulators seem to support command line option <b>&quot;-e&quot;</b> that is followed by a list of arguments that are to be executed in a shell.</div>
</div>
<div class='def-row'>
<div class='def-label'>Examples:</div>
<div class='def-text'>xxx</div>
</div>
<div class='def-break'></div>
<div class='def-row'>
<div class='def-empty'></div>
<div class='def-text'><pre><b>terminal</b> <b>-c</b>             # check only, do not run
<b>terminal</b>                # open a terminal (desktop only)
<b>terminal</b> <b>--</b> top         # run a program, wait for exit</pre></div>
</div>
</section>
</article>
<div class='def-break'></div>
<nav><div class='nav-row'>
<div class='nav-left'><a href='_centauri_bash_pro.html'>[&lt;&lt; previous]</a></div>
<div class='nav-mid'><a href='#top'>[Top of Page]</a></div>
<div class='nav-mid'><a href='reference.html#top'>[Reference]</a></div>
<div class='nav-right'><a href='_centauri_bash_svc.html'>[next &gt;&gt;]</a></div>
</div></nav>
</body></html>
